---
description: Go 1.22-1.25 - Features Modernas (Tool Dependencies, GOAUTH, Telemetria)
---

# Go 1.22-1.25: A era das features modernas

## VisÃ£o geral

Go 1.22-1.25 poliu o sistema de mÃ³dulos com features modernas focadas em **produtividade**, **seguranÃ§a** e **observabilidade**.

**Timeline**:
- Go 1.22: Fevereiro 2024
- Go 1.23: Agosto 2024
- Go 1.24: Fevereiro 2025
- Go 1.25: Agosto 2025

---

## Go 1.22 (Fevereiro 2024)

### ðŸ”„ go work vendor

Workspace agora suporta vendoring!

```bash
# Criar vendor para workspace inteiro
go work vendor

# Build usando vendor
go build -mod=vendor ./...
```

### ðŸ”§ for loop "fix"

Finalmente! VariÃ¡veis de loop nÃ£o vazam:

```go
// Go â‰¤ 1.21: Bug clÃ¡ssico
for i := range items {
    go func() {
        fmt.Println(i)  // âŒ Sempre imprime Ãºltimo valor
    }()
}

// Go â‰¥ 1.22: Funciona corretamente!
for i := range items {
    go func() {
        fmt.Println(i)  // âœ… Valor correto
    }()
}
```

### ðŸ“Š Improved telemetry support

Go agora coleta telemetria (opt-in) para melhorar o Go:

```bash
# Opt-in
go telemetry on

# Opt-out (padrÃ£o)
go telemetry off

# Ver dados coletados
go telemetry view
```

### Outras melhorias

- `range` sobre integers
- Melhorias de performance
- Melhor suporte a WASM

---

## Go 1.23 (Agosto 2024)

### ðŸŽ¯ Improved Module Graph Resolution

ResoluÃ§Ã£o de dependÃªncias mais eficiente e correta.

### ðŸ” Enhanced Security Features

Melhorias no checksum database e proteÃ§Ãµes adicionais.

### ðŸ“¦ Better Workspace Integration

Workspaces agora integram melhor com todas as ferramentas.

### Outras melhorias

- Iterator support (experimental)
- Performance de garbage collector
- Melhorias no compilador

---

## Go 1.24 (Fevereiro 2025)

### ðŸ› ï¸ `tool` directive

**FEATURE MUITO ESPERADA!**

Finalmente, gerenciamento oficial de ferramentas:

```go
// go.mod
module example.com/project

go 1.25

// DependÃªncias de runtime
require (
    github.com/gin-gonic/gin v1.10.0
)

// Ferramentas de desenvolvimento
tool (
    golang.org/x/tools/cmd/goimports
    github.com/golangci/golangci-lint/cmd/golangci-lint
    github.com/swaggo/swag/cmd/swag
)
```

**Comandos**:
```bash
# Adicionar ferramenta
go get -tool github.com/golangci/golangci-lint/cmd/golangci-lint@latest

# Executar ferramenta
go tool golangci-lint run

# Instalar ferramentas
go install tool  # Instala todas no GOBIN
```

Ver capÃ­tulo completo: [Tool Dependencies](../avancado/tool-dependencies.md)

### ðŸ” GOAUTH - Module Authentication

Sistema moderno de autenticaÃ§Ã£o para mÃ³dulos privados:

```bash
# GitHub
export GOAUTH="github.com/empresa=git:echo username=token:$GITHUB_TOKEN"

# GitLab
export GOAUTH="gitlab.empresa.com=netrc"

# Custom
export GOAUTH="git.empresa.com=command:/usr/local/bin/auth-helper"
```

**Provedores suportados**:
- `git` - Git credential helper
- `netrc` - Arquivo ~/.netrc
- `command` - Script customizado
- `off` - Desabilita autenticaÃ§Ã£o

Ver capÃ­tulo: [Security Features](../avancado/security-features.md)

### ðŸ“‹ Structured Output (-json flags)

Muitos comandos agora suportam `-json`:

```bash
# go list com JSON
go list -json -m all

# go build com JSON
go build -json ./...

# go test com JSON
go test -json ./...
```

**BenefÃ­cios**:
- Parsing fÃ¡cil em scripts
- IntegraÃ§Ã£o com ferramentas
- CI/CD mais robusto

### ðŸ”„ `go run` caching

`go run` agora cacheia executÃ¡veis:

```bash
# Primeira execuÃ§Ã£o: compila
go run main.go  # 2s

# Segunda execuÃ§Ã£o: usa cache
go run main.go  # 0.1s
```

### Outras melhorias

- Melhorias no PGO
- Performance geral
- Suporte a novas plataformas

---

## Go 1.25 (Agosto 2025)

### ðŸš« `ignore` directive

Ignore diretÃ³rios ao matching patterns:

```go
// go.mod
module example.com/project

go 1.25

// Ignorar diretÃ³rios especÃ­ficos
ignore (
    testdata
    _examples
    deprecated
)
```

**Uso**:
```bash
# ./... agora ignora os diretÃ³rios especificados
go build ./...
go test ./...
```

### ðŸ“ Suporte a subdiretÃ³rios de mÃ³dulo

MÃ³dulos agora podem estar em subdiretÃ³rios de repos:

```
github.com/org/repo
â”œâ”€â”€ go.mod (root module)
â””â”€â”€ subproject/
    â””â”€â”€ go.mod (submodule!)
```

**Sintaxe**:
```
import "github.com/org/repo/subproject@subdirectory"
```

### ðŸŽ¯ Novo padrÃ£o de uso do `work`

Novo pattern para workspace modules:

```bash
# Testa todos os pacotes em TODOS os mÃ³dulos do workspace
go test work

# Build todos os mÃ³dulos do workspace
go build work
```

### ðŸ“Š `go doc -http`

Servidor de documentaÃ§Ã£o integrado:

```bash
# Iniciar servidor de docs
go doc -http :8080

# Abre automaticamente no browser
# Mostra docs de todos os mÃ³dulos do workspace
```

### ðŸ³ Container-Aware GOMAXPROCS

Go agora detecta limites de containers (Kubernetes, Docker):

```go
// Antes: GOMAXPROCS = nÃºmero de CPUs na mÃ¡quina (ex: 96)
// Mesmo se container limitado a 2 CPUs!

// Go 1.25: GOMAXPROCS = CPUs do container (ex: 2)
// Automaticamente!
```

**BenefÃ­cios**:
- Melhor performance em Kubernetes
- Menos contenÃ§Ã£o
- Uso otimizado de recursos

### ðŸ—‘ï¸ Green Tea Garbage Collector (Experimental)

Novo GC experimental com pausas ainda menores:

```bash
GOEXPERIMENT=greentea go build
```

### ðŸ”§ AtualizaÃ§Ãµes em toolchain

- Toolchain nÃ£o Ã© mais adicionado automaticamente ao atualizar `go` line
- Melhor controle de versÃµes

### Outras melhorias

- Performance do compilador
- Melhorias em generics
- Suporte a novas arquiteturas
- Melhorias no runtime

---

## ComparaÃ§Ã£o de features

| VersÃ£o | Feature Destaque | Categoria |
|--------|------------------|-----------|
| **1.22** | `go work vendor` | Workflow |
| **1.23** | Telemetria | Observability |
| **1.24** | `tool` directive + GOAUTH | Produtividade |
| **1.25** | `ignore` + `work` pattern | Refinamento |

---

## Stack moderna (Go 1.25)

### Um `go.mod` completo

```go
module github.com/empresa/api

go 1.25

// DependÃªncias de runtime
require (
    github.com/gin-gonic/gin v1.10.0
    gorm.io/gorm v1.25.10
)

// DependÃªncias indiretas
require (
    github.com/gin-contrib/sse v0.1.0 // indirect
    // ...
)

// Ferramentas de desenvolvimento
tool (
    golang.org/x/tools/cmd/goimports
    github.com/golangci/golangci-lint/cmd/golangci-lint
    github.com/swaggo/swag/cmd/swag
)

// Ignorar diretÃ³rios
ignore (
    testdata
    _examples
)
```

### O workflow completo

```bash
# 1. Setup inicial
go work init ./service1 ./service2

# 2. Baixar deps + ferramentas
go mod download

# 3. Instalar ferramentas
go install tool

# 4. Desenvolvimento
go tool goimports -w .
go tool golangci-lint run
go test work  # Testa todos os mÃ³dulos do workspace

# 5. Build
go build ./...  # Usa container-aware GOMAXPROCS
```

---

## MigraÃ§Ã£o para Go 1.24-1.25

### PreparaÃ§Ã£o

```bash
# 1. Atualizar Go
go install golang.org/dl/go1.25@latest
go1.25 download

# 2. Atualizar go.mod
go mod edit -go=1.25
go mod edit -toolchain=go1.25.0

# 3. Migrar ferramentas
go get -tool golang.org/x/tools/cmd/goimports@latest
go get -tool github.com/golangci/golangci-lint/cmd/golangci-lint@latest

# 4. Remover tools.go (se existir)
rm tools.go

# 5. Adicionar ignore se necessÃ¡rio
go mod edit -ignore=testdata -ignore=_examples

# 6. Tidy
go mod tidy

# 7. Testar
go build ./...
go test work
```

### Configurar GOAUTH

```bash
# Para mÃ³dulos privados
export GOAUTH="github.com/empresa=git:echo username=token:${GITHUB_TOKEN}"

# Adicionar ao ~/.bashrc ou ~/.zshrc
echo 'export GOAUTH="github.com/empresa=git:echo username=token:${GITHUB_TOKEN}"' >> ~/.bashrc
```

---

## Checklist de atualizaÃ§Ã£o

### Go 1.22

- [ ] Usar `go work vendor` se aplicÃ¡vel
- [ ] Aproveitar fix de for loop
- [ ] Decidir sobre telemetria

### Go 1.23

- [ ] Testar melhorias de resoluÃ§Ã£o de deps
- [ ] Atualizar ferramentas de seguranÃ§a

### Go 1.24

- [ ] **Migrar para `tool` directive**
- [ ] Configurar `GOAUTH` para repos privados
- [ ] Usar `-json` flags em CI/CD
- [ ] Aproveitar `go run` caching

### Go 1.25

- [ ] Adicionar `ignore` directive se necessÃ¡rio
- [ ] Usar `work` pattern em workspaces
- [ ] Testar `go doc -http`
- [ ] Verificar GOMAXPROCS em containers
- [ ] Avaliar Green Tea GC (experimental)

---

## Recursos adicionais

- [Go 1.22 Release Notes](https://go.dev/doc/go1.22)
- [Go 1.23 Release Notes](https://go.dev/doc/go1.23)
- [Go 1.24 Release Notes](https://go.dev/doc/go1.24)
- [Go 1.25 Release Notes](https://go.dev/doc/go1.25)
- [Tool Directive Proposal](https://go.googlesource.com/proposal/+/54d6775ff71ccbc00c276db2a4e4841d67011cf4/design/48429-go-tool-modules.md)
- [GOAUTH Documentation](https://go.dev/ref/mod#module-authentication)

---

## Resumo: O estado atual (Go 1.25)

Go modules em 2025 Ã© **maduro, poderoso e produtivo**:

### Problemas resolvidos

| Problema | SoluÃ§Ã£o (Go 1.25) |
|----------|-------------------|
| Gerenciar ferramentas | âœ… `tool` directive |
| AutenticaÃ§Ã£o privada | âœ… `GOAUTH` |
| Multi-module dev | âœ… Workspace mode |
| VersÃµes do Go | âœ… Toolchain management |
| Performance | âœ… Lazy loading + pruning |
| SeguranÃ§a | âœ… GOVCS + Checksum DB + GOAUTH |

### Stack recomendada 2025

```
Go 1.25
â”œâ”€ MÃ³dulos (obrigatÃ³rios)
â”œâ”€ Workspace (multi-module)
â”œâ”€ Toolchain automÃ¡tico
â”œâ”€ Tool directive (ferramentas)
â”œâ”€ GOAUTH (auth moderna)
â”œâ”€ Lazy loading (performance)
â””â”€ Container-aware (K8s)
```

{% hint style="success" %}
**Go 1.25 representa o Ã¡pice de 7 anos de evoluÃ§Ã£o do sistema de mÃ³dulos. Ã‰ robusto, seguro, rÃ¡pido e um prazer de usar!**
{% endhint %}
